{
    "collab_server" : "",
    "contents" : "library(\"tidyverse\")\nlibrary(\"lubridate\")\nlibrary(\"stringr\")\n\ndesktop_survey <- read_csv(\"data-raw/desktop-surveys.csv\")\ncolnames(desktop_survey) <-\n  c(\"time\", \"desktop.items\", \"os\", \"department\", \"university\")\n\ndesktop_survey <- desktop_survey %>%\n  mutate(desktop.items = trimws(gsub(\"[^0-9]\", \"\", desktop.items)),\n         desktop.items = as.integer(desktop.items)) %>%\n  filter(desktop.items <= 500) %>%\n  mutate(time = mdy_hms(time, truncated = 2))\n\n## === Sanitise departments\n\n## There's a date in the department\ndesktop_survey <- desktop_survey %>%\n  filter(!grepl(\"/\", department))\n\n## Replace any department with IT in it with IT\ndesktop_survey <- desktop_survey %>%\n  mutate(department = ifelse(\n    grepl(\"IT\", department),\n    \"IT\",\n    department\n  ))\n\n## Replace any department with Libraries in it with Libraries\ndesktop_survey <- desktop_survey %>%\n  mutate(department = ifelse(\n    grepl(\"Libraries\", department),\n    \"Libraries\",\n    department\n  )) %>%\n  mutate(\n    department = ifelse(\n      grepl(\"Library\", department),\n      \"Libraries\",\n      department\n    )\n  )\n\n## === Sanitize Universities\n\ndesktop_survey <- desktop_survey %>%\n  mutate(university = str_replace_all(\n    university,\n    c(\n      'Universit of Oxford' = 'University of Oxford',\n      'Universtiy of Oxford' = 'University of Oxford',\n      'The University of Oxford' = 'University of Oxford'\n    )\n  )) %>%\n  mutate(university = gsub(\"^Oxford\", \"University of Oxford\", university),\n         university = gsub(\"Durham University\", \"University of Durham\", university),\n         university = gsub(\"^Durham\", \"University of Durham\", university))\n\n## === Export\n\ndesktop_survey %>%\n  write_csv(\"data/desktop-survey.csv\")\n\n\n",
    "created" : 1503669943620.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3951542414",
    "id" : "B47DEBF0",
    "lastKnownWriteTime" : 1503673225,
    "last_content_update" : 1503673254756,
    "path" : "~/Google Drive/VisibleData/RSS/2017/RSS-2017-Conference/OxfordIDN-Training-Interactive-Viz-with-R/RSS_handouts/plotly-desktop-items/data-raw/clean-data.R",
    "project_path" : "data-raw/clean-data.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}